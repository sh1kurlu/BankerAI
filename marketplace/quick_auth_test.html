<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quick Auth Test - CustomerAI</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; background: #f5f5f5; }
        .container { max-width: 400px; margin: 0 auto; background: white; padding: 30px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        input { width: 100%; padding: 10px; margin: 10px 0; border: 1px solid #ddd; border-radius: 5px; }
        button { width: 100%; padding: 12px; margin: 10px 0; border: none; border-radius: 5px; background: #007bff; color: white; cursor: pointer; }
        button:hover { background: #0056b3; }
        .success { color: green; }
        .error { color: red; }
        .info { background: #e3f2fd; padding: 10px; border-radius: 5px; margin: 10px 0; }
    </style>
</head>
<body>
    <div class="container">
        <h2>üöÄ Quick Authentication Test</h2>
        <p>Test the authentication system and go to the AI marketplace.</p>
        
        <div class="info">
            <strong>Test User:</strong><br>
            Username: testuser<br>
            Password: password123
        </div>
        
        <button onclick="createTestUser()">1. Create Test User</button>
        <button onclick="loginTestUser()">2. Login Test User</button>
        <button onclick="goToMarketplace()">3. Go to AI Marketplace</button>
        
        <div id="status"></div>
    </div>

    <script>
        function showStatus(message, type = 'info') {
            document.getElementById('status').innerHTML = `<div class="${type}">${message}</div>`;
        }
        
        function createTestUser() {
            const testUser = {
                id: 'test_user_12345',
                username: 'testuser',
                email: 'test@example.com',
                password: 'password123',
                createdAt: new Date().toISOString()
            };
            
            // Get existing users
            let users = [];
            try {
                const usersJson = localStorage.getItem('marketplace_users');
                users = usersJson ? JSON.parse(usersJson) : [];
            } catch (error) {
                users = [];
            }
            
            // Check if user already exists
            if (users.find(u => u.username === testUser.username)) {
                showStatus('‚úÖ Test user already exists!', 'success');
                return;
            }
            
            // Add test user
            users.push(testUser);
            localStorage.setItem('marketplace_users', JSON.stringify(users));
            
            showStatus('‚úÖ Test user created successfully!', 'success');
        }
        
        function loginTestUser() {
            const username = 'testuser';
            const password = 'password123';
            
            try {
                const usersJson = localStorage.getItem('marketplace_users');
                const users = usersJson ? JSON.parse(usersJson) : [];
                const user = users.find(u => u.username === username && u.password === password);
                
                if (user) {
                    // Set current user
                    localStorage.setItem('marketplace_current_user', JSON.stringify(user));
                    localStorage.setItem('marketplace_user_id', user.id);
                    
                    showStatus(`‚úÖ Login successful! User ID: ${user.id}`, 'success');
                } else {
                    showStatus('‚ùå Invalid credentials. Create test user first.', 'error');
                }
            } catch (error) {
                showStatus('‚ùå Error: ' + error.message, 'error');
            }
        }
        
        function goToMarketplace() {
            const currentUser = localStorage.getItem('marketplace_current_user');
            if (currentUser) {
                window.location.href = 'realtime_marketplace.html';
            } else {
                showStatus('‚ùå Please login first!', 'error');
            }
        }
        
        // Check current state on load
        window.onload = function() {
            const currentUser = localStorage.getItem('marketplace_current_user');
            if (currentUser) {
                const user = JSON.parse(currentUser);
                showStatus(`‚ÑπÔ∏è Already logged in as: ${user.username}`, 'info');
            }
        };
    </script>
</body>
</html>